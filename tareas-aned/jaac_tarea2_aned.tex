\documentclass[11pt]{article}
\usepackage[left=3.5cm,right=3.5cm,top=2.5cm,bottom=2.5cm]{geometry}
%\usepackage[spanish]{babel}

\usepackage{amsmath,amsfonts,amsthm}
\usepackage{enumitem,mathtools,graphicx}
\setenumerate[0]{label=(\alph*)}

\newtheorem{definition}{Definición}
\newtheorem{exercise}{Ejercicio}
\newtheorem*{sol}{Solución}
\newtheorem*{theorem}{Teorema}

\newcommand\N{\mathbb N}
\newcommand\R{\mathbb R}

\title{Análisis numérico para ecuaciones diferenciales \\
Tarea 2 - Estabilidad absoluta, ecuaciones en diferencias finitas y
métodos multipaso}
\author{Jorge Alfredo Álvarez Contreras}

\begin{document}
\maketitle

\begin{exercise}
   Se sabe que al aplicar el método de Euler al problema de valores
   iniciales $y'=y$, $y(0)=1$, se obtienen las aproximaciones
   $u_n=(1+h)^{t_n / h}$.
   \begin{enumerate}
     \item
       Demuestre que $y_n-u_n = \frac{1}{2}ht_ne^{t_n}+O(h^{2})$.
     \item
       Usando el resultado anterior, determine el tamaño de paso más
       grande posible para aproximar $y(1)$ con una tolerancia de
       $10^{-5}$. ¿Cuántos pasos de Euler se tienen que dar para
       obtener dicha aproximación de $y(1)$?
   \end{enumerate}
\end{exercise}
\begin{sol}

  \begin{align}
    y_{n+1}
    &= y_n + hy'_n + O(h^{2}) \\
    &= (1 + h)y_n + O(h^{2}) \\
  \end{align}
  \begin{align}
    u_{n+1} = (1 + h)u_n
  .\end{align}
  asì que
  \begin{equation}
    y_{n+1}-u_{n+1}
    = (1+h)(y_n-u_n) + O(h^{2})
  .\end{equation}
  
  Notemos que
  \begin{align}
    u_n
    &= (1+h)^{t_n/h} \\
    &= (1+h)^{n} \\
    &= 1 + nh + \frac{n(n-1)}{2} h^{2} + O(h^{3}) \\
    &= 1 + t_n + \frac{t_n^{2}}{2} - \frac{ht_n}{2} + O(h^{3})
  .\end{align}
  
  \begin{align}
    y_n
    &= e^{t_n} \\
    &= 1 + t_n + \frac{1}{2}t_n^{2} + \frac{1}{3!}t_n^{3} + \dots \\
  .\end{align}
  
  
  \begin{align}
    e^{t}
    &= 1 + t + \frac{t^{2}}{2} + \frac{t^{3}}{3!} + \dots \\
    &= 1 + t(1 + \frac{t}{2} + \frac{t^{2}}{3!} + \dots) \\
  .\end{align}
  
  
  
  \begin{enumerate}
    \item
      La solución exacta es $y(t)=e^t$, así que $y_n=e^{t_n}$.
      \begin{align}
        y_n - u_n
        &= e^{t_n} - (1+h)^{t_n/h} \\
        &= e^{t_n} - (1+h)^{n} \\
        &= e^{t_n} - 1 - h + O(h^{2}) \\
      .\end{align}
  \end{enumerate}
\end{sol}

\begin{exercise}
  Determine y grafique (con ayuda de \texttt{python}) la región de
  estabilidad absoluta de los métodos
  \begin{enumerate}
    \item
      Heun
    \item
      BDF2
  \end{enumerate}
\end{exercise}

\begin{exercise}
  Resuelva la ecuación en diferencias
  \begin{equation}
    u_{n+4} - 6u_{n+3} + 14u_{n+2} - 16 u_{n+1} + 8u_{n} = n
  \end{equation}
  con las condiciones $u_0=1$, $u_1=2$, $u_2=3$, $u_3=4$.

  \emph{Solución: $u_n=2^n(n / 4 -1) + 2^{(n-2) / 2}\sin(n\pi /
  4)+n+2$}.
\end{exercise}

\begin{exercise}
  Calcule el error de truncamiento local $\tau_{n+1}(h)$ y la
  constante de error del método de Adams-Moulton AM3.
\end{exercise}


\end{document}
